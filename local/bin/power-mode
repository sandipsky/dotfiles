#!/usr/bin/env bash

MODE="$1"

# Get focused monitor name
MONITOR=$(hyprctl monitors -j | jq -r '.[] | select(.focused==true).name')

if [[ -z "$MONITOR" ]]; then
    exit 1
fi

case "$MODE" in
    powersave|power-saver)
        powerprofilesctl set power-saver
        hyprctl keyword monitor "$MONITOR,1920x1080@60,auto,1"
        notify-send -u normal -a "System" "Power Saver Mode" "Refresh rate set to 60Hz"
        ;;
    balanced)
        powerprofilesctl set balanced
        hyprctl keyword monitor "$MONITOR,1920x1080@144,auto,1"
        notify-send -u normal -a "System" "Balanced Mode" "Refresh rate set to 144Hz"
        ;;
    performance|perf)
        powerprofilesctl set performance
        hyprctl keyword monitor "$MONITOR,1920x1080@144,auto,1"
        notify-send -u normal -a "System" "Performance Mode" "Refresh rate set to 144Hz"
        ;;
    *)
        notify-send -u normal -a "System" "Power Mode" "Usage: power-mode {powersave|performance}"
        echo "Usage: power-mode {powersave|performance}"
        exit 1
        ;;
esac

